{#
/**
 * @file
 * Default theme implementation for the DH Dashboard user card.
 *
 * Available variables:
 * - user.name: The user's display name
 * - user.roles: Array of user roles (excluding 'authenticated')
 * - user.picture: Rendered user picture
 * - attributes: HTML attributes for the containing element
 */
#}
<div{{ attributes.addClass('user-card', 'dh-card') }}>
  <div class="profile-header">
    <h2>{{ user.profile.field_name[0].value }} ({{ user.name }})</h2>
    <span class="accordion-toggle">
      Details <i class="fas fa-chevron-right"></i>
    </span>
  </div>
  
  <div class="profile-details" style="display: none;">
    <div class="profile-data">
      <div class="profile-field">
        <span class="profile-field-label">User Name:</span>
        <span class="profile-field-value">{{ user.name }}</span>
      </div>
      {% if user.profile %}
        {% for field, value in user.profile %}
          {% if field starts with 'field_' and field not in ['field_personal_statement', 'field_personal_statement_video'] %}
            {% set field_label = field|replace({'field_': 'Profile '})|title|replace({'_': ' '}) %}
            {% if value is iterable %}
              {% for item in value %}
                {% if item.format == 'basic_html' %}
                  <div class="profile-field">
                    <span class="profile-field-label">{{ field_label }}:</span>
                    <span class="profile-field-value">{{ item.value|raw }}</span>
                  </div>
                {% else %}
                  <div class="profile-field">
                    <span class="profile-field-label">{{ field_label }}:</span>
                    <span class="profile-field-value">{{ item.value }}</span>
                  </div>
                {% endif %}
              {% endfor %}
            {% else %}
              <div class="profile-field">
                <span class="profile-field-label">{{ field_label }}:</span>
                <span class="profile-field-value">{{ value }}</span>
              </div>
            {% endif %}
          {% endif %}
        {% endfor %}
      {% endif %}
    </div>

    <div class="profile-statement-video">
      {% if user.profile.field_personal_statement %}
        <div class="profile-statement">
          <h3>Personal Statement</h3>
          {% for item in user.profile.field_personal_statement %}
            <div class="profile-field">
              <span class="profile-field-value">{{ item.value|raw }}</span>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% if user.video_url %}
        <div class="profile-video">
          <h3>Personal Statement Video</h3>
          <a href="{{ user.video_url }}" data-lightbox="video" data-title="Personal Statement Video">
            <img src="{{ user.video_thumbnail_url }}" alt="Personal Statement Video Thumbnail" class="video-thumbnail">
          </a>
        </div>
      {% endif %}
    </div>

    {% if edit_url %}
      <a href="{{ edit_url }}" class="edit-profile-link">Edit Profile</a>
    {% endif %}

    {# {% if show_debug %} #}
      <div class="debug-output">
      </div>
    {# {% endif %} #}
  </div>
</div>
